# Nok lang (녹 언어) 0.1.0 d1 - 디자인 일기(Design Diary)

- 26/01/03 수정

# 버전 넘버링
0.1.0 a1, a2, a3 ... 과 b1, b2... 는 서로 호환이 안 되는 문법임<br>
즉, 문제가 생겼거나 문법을 바꾸는 경우 a->b, b->c로 바뀌며,<br>
이전 a 버전은 별도로 "복구"한다는 얘기가 없으면 폐기됨 (그런 설정임) <br>
z 뒤에는 aa, ab.. 순서로 시작<br>
a>b>c>...z>aa>ab>ac...>zz>aaa...


## 참고 언어
- 접해본 모든 언어 (대표적으로는 C/C++ Rust Lua Python Go)
- 학습용 언어 [プログラミング言語を作ろう](https://kmaebashi.com/programmer/devlang/index.html)

구현체는 C (또는 C++)
레지스터 기반 바이트코드 VM입니다.

## 목표/철학
뚜렷한 목표나 거창한건 없으며, 어느 언어를 대체한다는 목적도 아닙니다. 

다만 최소한의 목표, 철학은 
- 제1원칙 **컴파일러 구현하기 어렵지 않아야 함**
- 제2원칙 **간결한 문법, 사용하기 편해야 함**
- 제3원칙 **기존 언어에서 부족한 점을 보완**
- 제4원칙 개인적으로 있으면 **좋을거 같은 기능** 추가
- 제5원칙 **성능 하락**을 기피

그에 따라
- Garbage Collector 없음 (아레나 할당 / 메모리 풀을 이용한 방식을 고안 중)
- 구문 분석 시 가능하면 귀찮은거 생략 (콤마, 세미콜론, 괄호 등)
- 정적 타입 언어

# 구문 분석
구문분석기를 만들다 보니 생략이 가능하거나 필요없는 문법이 있다는걸 발견했습니다.

## 생략 여부 - LL 파서 기준
- 세미콜론
- 콤마 : 일반적으로 생략 가능. (10, -30)같은 경우는 불가능
- 중괄호 : {는 필요없고, }만 써도 됨. 파이썬 식의 Tab 지원도 가능함.
- 괄호(수식 제외) : if (~~)에서 ()는 생략 가능

그에 따라
- 세미콜론, 괄호 : 생략
- 콤마 : 생략 가능 (선택)
- 블록 : {}를 선호하나, 현재는 end로 정함.

## 문법 및 코드 스타일에 대해
개인적으로 엄격한 문법검사를 선호하지 않습니다. 
이유
- 구문 분석, 에러 처리가 복잡해짐
- 자유도 및 편이성이 떨어짐. 파이썬처럼 탭 스페이스에 강박적인 경우

```
# 스타일 1
while true
  # 내용
end

# 스타일 2
while true end
```

문법이 자유로운 경우 아래와 같은 단점도 예상됩니다.
- 개발자의 실수
- 가독성의 저해 가능성 : 띄어쓰기 중괄호 탭 등등
- 구조 분석의 어려움

C/C++ 같은 언어에서 중괄호 위치에 따라 논쟁이 있는 것,
언어마다 고정된 스타일을 중요시한다는 것은 잘 알고 있습니다.

그럼에도, 
구현이 어려워지고, 파싱 속도가 떨어지는 것은 제 철학 1,2에 위배됩니다.
현업을 위한 언어가 아닌, 개인 목적의 개발언어이기 때문이라는 점을 감안하여
개발자의 몫이라고 판단하여 제 기준으로 불필요한 구문분석은 생략합니다.

개인적으로 권장하는 코드 스타일은 올리도록 하겠습니다.

## 블록에 대해
일반적으로 파이썬이 최근 강력하게 쓰이고 있습니다.<br>
만, 그 때문에 탭, 공백문자, 엔터키를 마음놓고 못 씁니다.

Tab 단위로 블록을 관리한다는 점이 파이썬의 장점인 동시에 단점입니다. <br>
탭을 정확히 맞춰야 하고, 탭이 없어지면 코드 정보가 산산조각 난다는 무서운 점도 있습니다.<br>
일반적으로 space 4를 하나의 탭으로 보는데, 스페이스를 정확히 맞추는건 어려운 일입니다.<br>
ReadME 파일에서도 space 2로 인식됨

```
if state1():
  print(10)

```
파이썬 블록을 포기한다해도, 중괄호 {}는 아직 미정이나 특수한 용도로 사용하는게 좋을 것 같다고 판단했습니다.
따라서 ruby, lua처럼 end를 쓰도록 했습니다. <br>
`do`는 쓰지 않습니다.
단, 파이썬 루비 둘 다 블록을 시작할때 : do를 쓰나, 의미가 없으므로(**제3원칙**) Nok lang에선 생략합니다.

물론 파이썬 방식을 포기하면, 여전히 번거롭게
```
{{{{ }}}}
    end
  end
end
```

이런 노가다를 해야할 수 있습니다. 아직까지는 Tab을 이용하지 않으면 해결할 수 없는 문제입니다.<br>
그럼에도, 조금 줄일 수 있는 팁이 있다고 하면, `endfunc` 같은 키워드 만들거나VB Net처럼 `end func` `end:func` 이런식으로 하는 것 입니다.
그러면 짜잔
```
func main()
  while blabla
    if n==10
      io.print('어쩌고 저쩌고')
end:func

근데 생각해보니 }}} 이렇게 쓰면 되는거 아닌가?
```

완벽하진 않아도 쉽게 축약이 됩니다. 파이썬 정도는 아니라도 비슷한 효과를 낼 수는 있죠<br>
마음에 안 들면 님이 해보셈 <br>
다른 방식도 있는데 굳이 설명 안하겠습니다. 궁금하면 예전에 만든 [ipari 스크립트](https://github.com/Noksek2/ipari-script) 참고

- Python : 축약 O, 탭 독립성 X
- Ruby : 축약 X, 탭 독립성 O
- Nok : 축약 △, 탭 독립성 O
